<!DOCTYPE html>
<html lang="hi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RIKO</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&family=Inter:wght@300;400;500&family=Noto+Sans+Devanagari:wght@300;400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/public/css/style.css">
</head>

<body>
    <!-- VRM 3D Avatar Canvas (Full Screen) -->
    <canvas id="vrm-canvas"></canvas>

    <!-- Minimal Status (top-right corner) -->
    <div class="mini-status" id="miniStatus">
        <span class="mini-dot" id="miniDot"></span>
        <span class="mini-text" id="miniText"></span>
    </div>

    <!-- Settings Button (top-right) -->
    <button class="settings-float" id="settingsBtn" title="Settings">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <path
                d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42">
            </path>
        </svg>
    </button>

    <!-- Mic Button (bottom center, minimal) -->
    <button class="mic-float" id="micBtn" title="‡§¨‡•ã‡§≤‡•ã 'Riko'">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
            <line x1="12" y1="19" x2="12" y2="23"></line>
            <line x1="8" y1="23" x2="16" y2="23"></line>
        </svg>
        <div class="mic-ring"></div>
    </button>

    <!-- Subtitle Bar (shows what Riko says, at bottom) -->
    <div class="subtitle-bar" id="subtitleBar"></div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>‚öôÔ∏è Settings</h2>
                <button class="modal-close" id="closeSettings">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="apiKeyInput">üîë Groq API Key</label>
                    <div class="form-hint">Free from <a href="https://console.groq.com"
                            target="_blank">console.groq.com</a></div>
                    <input type="password" id="apiKeyInput" placeholder="gsk_xxxxxxxxxxxxxxxx">
                </div>
                <div class="form-group">
                    <label>üß† Memory</label>
                    <div class="memory-stats" id="memoryStats"><span>...</span></div>
                    <div class="btn-group">
                        <button class="btn-secondary" id="clearShortBtn">Clear Recent</button>
                        <button class="btn-danger" id="clearAllBtn">Clear All</button>
                    </div>
                </div>
                <div class="form-group">
                    <label>VRM Avatar Model</label>
                    <div class="vrm-dropzone" id="vrmDropzone">
                        Drag & Drop .vrm file here<br>or click to upload
                    </div>
                    <input type="file" id="vrmFileInput" accept=".vrm" style="display:none">
                </div>

                <button id="saveKeyBtn" class="btn-primary">Connect & Start</button>
                <div style="margin-top: 10px; display: flex; gap: 10px;">
                    <button id="testAudioBtn" class="btn-secondary" style="flex: 1;">üîä Test Audio</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden chat container for memory (not displayed) -->
    <div id="chatMessages" style="display:none;"></div>



    <!-- Three.js + VRM CDN -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.161.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.161.0/examples/jsm/",
            "@pixiv/three-vrm": "https://cdn.jsdelivr.net/npm/@pixiv/three-vrm@3.3.3/lib/three-vrm.module.min.js"
        }
    }
    </script>
    <script type="module" src="/public/js/vrm-manager.js"></script>
    <script type="module" src="/public/js/app.js"></script>
</body>

</html>